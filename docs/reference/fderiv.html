<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>First derivatives of fitted GAM functions — fderiv • gratia</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="First derivatives of fitted GAM functions — fderiv"><meta property="og:description" content="
This function was deprecated because it was limited to first order forward
finite differences for derivatives only, but couldn't be improved to offer
the needed functionality without breaking backwards compatability with papers
and blog posts that already used fderiv(). A replacement, derivatives(),
is now available and recommended for new analyses."><meta property="og:image" content="https://gavinsimpson.github.io/gratia/reference/figures/README-draw-gam-figure-1.png"><meta property="og:image:alt" content="Plot produced by draw() of 4 smooth functions from a fitted generalized additive model"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@ucfagls"><meta name="twitter:site" content="@ucfagls"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gratia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.9850</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/gavinsimpson/gratia/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>First derivatives of fitted GAM functions</h1>
    <small class="dont-index">Source: <a href="https://github.com/gavinsimpson/gratia/blob/HEAD/R/fderiv.R" class="external-link"><code>R/fderiv.R</code></a></small>
    <div class="hidden name"><code>fderiv.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a></p>
<p>This function was deprecated because it was limited to first order forward
finite differences for derivatives only, but couldn't be improved to offer
the needed functionality without breaking backwards compatability with papers
and blog posts that already used <code>fderiv()</code>. A replacement, <code><a href="derivatives.html">derivatives()</a></code>,
is now available and recommended for new analyses.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">fderiv</span><span class="op">(</span><span class="va">model</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for gam</span>
<span class="fu">fderiv</span><span class="op">(</span>
  <span class="va">model</span>,
  <span class="va">newdata</span>,
  <span class="va">term</span>,
  n <span class="op">=</span> <span class="fl">200</span>,
  eps <span class="op">=</span> <span class="fl">1e-07</span>,
  unconditional <span class="op">=</span> <span class="cn">FALSE</span>,
  offset <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for gamm</span>
<span class="fu">fderiv</span><span class="op">(</span><span class="va">model</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>model</dt>
<dd><p>A fitted GAM. Currently only models fitted by <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">mgcv::gam()</a></code> and
<code><a href="https://rdrr.io/pkg/mgcv/man/gamm.html" class="external-link">mgcv::gamm()</a></code> are supported.</p></dd>
<dt>...</dt>
<dd><p>Arguments that are passed to other methods.</p></dd>
<dt>newdata</dt>
<dd><p>a data frame containing the values of the model covariates at
which to evaluate the first derivatives of the smooths.</p></dd>
<dt>term</dt>
<dd><p>character; vector of one or more terms for which derivatives are
required. If missing, derivatives for all smooth terms will be returned.</p></dd>
<dt>n</dt>
<dd><p>integer; if <code>newdata</code> is missing the original data can be
reconstructed from <code>model</code> and then <code>n</code> controls the number of values over
the range of each covariate with which to populate <code>newdata</code>.</p></dd>
<dt>eps</dt>
<dd><p>numeric; the value of the finite difference used to approximate
the first derivative.</p></dd>
<dt>unconditional</dt>
<dd><p>logical; if <code>TRUE</code>, the smoothing parameter uncertainty
corrected covariance matrix is used, <em>if available</em>, otherwise the
uncorrected Bayesian posterior covariance matrix is used.</p></dd>
<dt>offset</dt>
<dd><p>numeric; value of offset to use in generating predictions.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of class <code>"fderiv"</code> is returned.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Gavin L. Simpson</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="load_mgcv.html">load_mgcv</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># \dontshow{</span></span>
<span class="r-in"><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>lifecycle_verbosity <span class="op">=</span> <span class="st">"quiet"</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="data_sim.html">data_sim</a></span><span class="op">(</span><span class="st">"eg1"</span>, seed <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">gam</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">x0</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x3</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dat</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## first derivatives of all smooths...</span></span>
<span class="r-in"><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu">fderiv</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## now use --&gt;</span></span>
<span class="r-in"><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="derivatives.html">derivatives</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## ...and a selected smooth</span></span>
<span class="r-in"><span class="va">fd2</span> <span class="op">&lt;-</span> <span class="fu">fderiv</span><span class="op">(</span><span class="va">mod</span>, term <span class="op">=</span> <span class="st">"x1"</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## now use --&gt;</span></span>
<span class="r-in"><span class="va">fd2</span> <span class="op">&lt;-</span> <span class="fu"><a href="derivatives.html">derivatives</a></span><span class="op">(</span><span class="va">mod</span>, term <span class="op">=</span> <span class="st">"s(x1)"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Models with factors</span></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="data_sim.html">data_sim</a></span><span class="op">(</span><span class="st">"eg4"</span>, n <span class="op">=</span> <span class="fl">400</span>, dist <span class="op">=</span> <span class="st">"normal"</span>, scale <span class="op">=</span> <span class="fl">2</span>, seed <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">gam</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">x0</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op">+</span> <span class="va">fac</span>, data <span class="op">=</span> <span class="va">dat</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## first derivatives of all smooths...</span></span>
<span class="r-in"><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu">fderiv</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## now use --&gt;</span></span>
<span class="r-in"><span class="va">fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="derivatives.html">derivatives</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## ...and a selected smooth</span></span>
<span class="r-in"><span class="va">fd2</span> <span class="op">&lt;-</span> <span class="fu">fderiv</span><span class="op">(</span><span class="va">mod</span>, term <span class="op">=</span> <span class="st">"x1"</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## now use --&gt;</span></span>
<span class="r-in"><span class="va">fd2</span> <span class="op">&lt;-</span> <span class="fu"><a href="derivatives.html">derivatives</a></span><span class="op">(</span><span class="va">mod</span>, term <span class="op">=</span> <span class="st">"s(x1)"</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Gavin L. Simpson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

